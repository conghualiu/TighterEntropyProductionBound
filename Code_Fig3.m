%%Calculation code for Fig.3
clear all;clc;%calculate d fixed wc change,average EP
AV1=zeros(1,11);ST1=zeros(1,11);FD1=zeros(1,11);STFD1=zeros(1,11);
AV2=zeros(1,11);ST2=zeros(1,11);FD2=zeros(1,11);STFD2=zeros(1,11);
AV3=zeros(1,11);ST3=zeros(1,11);FD3=zeros(1,11);STFD3=zeros(1,11);
AV4=zeros(1,11);ST4=zeros(1,11);FD4=zeros(1,11);STFD4=zeros(1,11);

datastr=load('wcbian\d02wc0\ATEd02wc0.mat');
data=datastr.ATEd02wc0;
datastr1=load('wcbian\d02wc0\FDd02wc0.mat');
data1=datastr1.FDd02wc0;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,1)=av1;ST1(1,1)=st1;FD1(1,1)=avfd1;STFD1(1,1)=stfd1;
AV2(1,1)=av2;ST2(1,1)=st2;FD2(1,1)=avfd2;STFD2(1,1)=stfd2;
AV3(1,1)=av3;ST3(1,1)=st3;FD3(1,1)=avfd3;STFD3(1,1)=stfd3;
AV4(1,1)=av4;ST4(1,1)=st4;FD4(1,1)=avfd4;STFD4(1,1)=stfd4;

datastr=load('wcbian\d02wc01\ATEd02wc01.mat');
data=datastr.ATEd02wc01;
datastr1=load('wcbian\d02wc01\FDd02wc01.mat');
data1=datastr1.FDd02wc01;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,2)=av1;ST1(1,2)=st1;FD1(1,2)=avfd1;STFD1(1,2)=stfd1;
AV2(1,2)=av2;ST2(1,2)=st2;FD2(1,2)=avfd2;STFD2(1,2)=stfd2;
AV3(1,2)=av3;ST3(1,2)=st3;FD3(1,2)=avfd3;STFD3(1,2)=stfd3;
AV4(1,2)=av4;ST4(1,2)=st4;FD4(1,2)=avfd4;STFD4(1,2)=stfd4;

datastr=load('wcbian\d02wc02\ATEd02wc02.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc02\FDd02wc02.mat');
data1=datastr1.FD;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,3)=av1;ST1(1,3)=st1;FD1(1,3)=avfd1;STFD1(1,3)=stfd1;
AV2(1,3)=av2;ST2(1,3)=st2;FD2(1,3)=avfd2;STFD2(1,3)=stfd2;
AV3(1,3)=av3;ST3(1,3)=st3;FD3(1,3)=avfd3;STFD3(1,3)=stfd3;
AV4(1,3)=av4;ST4(1,3)=st4;FD4(1,3)=avfd4;STFD4(1,3)=stfd4;

datastr=load('wcbian\d02wc03\ATEd02wc03.mat');
data=datastr.ATEd02wc03;
datastr1=load('wcbian\d02wc03\FDd02wc03.mat');
data1=datastr1.FDd02wc03;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,4)=av1;ST1(1,4)=st1;FD1(1,4)=avfd1;STFD1(1,4)=stfd1;
AV2(1,4)=av2;ST2(1,4)=st2;FD2(1,4)=avfd2;STFD2(1,4)=stfd2;
AV3(1,4)=av3;ST3(1,4)=st3;FD3(1,4)=avfd3;STFD3(1,4)=stfd3;
AV4(1,4)=av4;ST4(1,4)=st4;FD4(1,4)=avfd4;STFD4(1,4)=stfd4;

datastr=load('wcbian\d02wc04\ATEd02wc04.mat');
data=datastr.ATEd02wc04;
datastr1=load('wcbian\d02wc04\FDd02wc04.mat');
data1=datastr1.FDd02wc04;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,5)=av1;ST1(1,5)=st1;FD1(1,5)=avfd1;STFD1(1,5)=stfd1;
AV2(1,5)=av2;ST2(1,5)=st2;FD2(1,5)=avfd2;STFD2(1,5)=stfd2;
AV3(1,5)=av3;ST3(1,5)=st3;FD3(1,5)=avfd3;STFD3(1,5)=stfd3;
AV4(1,5)=av4;ST4(1,5)=st4;FD4(1,5)=avfd4;STFD4(1,5)=stfd4;

datastr=load('wcbian\d02wc05\ATEd02wc05.mat');
data=datastr.ATEd02wc05;
datastr1=load('wcbian\d02wc05\FDd02wc05.mat');
data1=datastr1.FDd02wc05;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,6)=av1;ST1(1,6)=st1;FD1(1,6)=avfd1;STFD1(1,6)=stfd1;
AV2(1,6)=av2;ST2(1,6)=st2;FD2(1,6)=avfd2;STFD2(1,6)=stfd2;
AV3(1,6)=av3;ST3(1,6)=st3;FD3(1,6)=avfd3;STFD3(1,6)=stfd3;
AV4(1,6)=av4;ST4(1,6)=st4;FD4(1,6)=avfd4;STFD4(1,6)=stfd4;

datastr=load('wcbian\d02wc06\ATEd02wc06.mat');
data=datastr.ATEd02wc06;
datastr1=load('wcbian\d02wc06\FDd02wc06.mat');
data1=datastr1.FDd02wc06;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,7)=av1;ST1(1,7)=st1;FD1(1,7)=avfd1;STFD1(1,7)=stfd1;
AV2(1,7)=av2;ST2(1,7)=st2;FD2(1,7)=avfd2;STFD2(1,7)=stfd2;
AV3(1,7)=av3;ST3(1,7)=st3;FD3(1,7)=avfd3;STFD3(1,7)=stfd3;
AV4(1,7)=av4;ST4(1,7)=st4;FD4(1,7)=avfd4;STFD4(1,7)=stfd4;

datastr=load('wcbian\d02wc07\ATEd02wc07.mat');
data=datastr.ATEd02wc07;
datastr1=load('wcbian\d02wc07\FDd02wc07.mat');
data1=datastr1.FDd02wc07;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,8)=av1;ST1(1,8)=st1;FD1(1,8)=avfd1;STFD1(1,8)=stfd1;
AV2(1,8)=av2;ST2(1,8)=st2;FD2(1,8)=avfd2;STFD2(1,8)=stfd2;
AV3(1,8)=av3;ST3(1,8)=st3;FD3(1,8)=avfd3;STFD3(1,8)=stfd3;
AV4(1,8)=av4;ST4(1,8)=st4;FD4(1,8)=avfd4;STFD4(1,8)=stfd4;

datastr=load('wcbian\d02wc08\ATEd02wc08.mat');
data=datastr.ATEd02wc08;
datastr1=load('wcbian\d02wc08\FDd02wc08.mat');
data1=datastr1.FDd02wc08;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,9)=av1;ST1(1,9)=st1;FD1(1,9)=avfd1;STFD1(1,9)=stfd1;
AV2(1,9)=av2;ST2(1,9)=st2;FD2(1,9)=avfd2;STFD2(1,9)=stfd2;
AV3(1,9)=av3;ST3(1,9)=st3;FD3(1,9)=avfd3;STFD3(1,9)=stfd3;
AV4(1,9)=av4;ST4(1,9)=st4;FD4(1,9)=avfd4;STFD4(1,9)=stfd4;

datastr=load('wcbian\d02wc09\ATEd02wc09.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc09\FDd02wc09.mat');
data1=datastr1.FD;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,10)=av1;ST1(1,10)=st1;FD1(1,10)=avfd1;STFD1(1,10)=stfd1;
AV2(1,10)=av2;ST2(1,10)=st2;FD2(1,10)=avfd2;STFD2(1,10)=stfd2;
AV3(1,10)=av3;ST3(1,10)=st3;FD3(1,10)=avfd3;STFD3(1,10)=stfd3;
AV4(1,10)=av4;ST4(1,10)=st4;FD4(1,10)=avfd4;STFD4(1,10)=stfd4;

datastr=load('wcbian\d02wc10\ATEd02wc10.mat');
data=datastr.ATEd02wc10;
datastr1=load('wcbian\d02wc10\FDd02wc10.mat');
data1=datastr1.FDd02wc10;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,11)=av1;ST1(1,11)=st1;FD1(1,11)=avfd1;STFD1(1,11)=stfd1;
AV2(1,11)=av2;ST2(1,11)=st2;FD2(1,11)=avfd2;STFD2(1,11)=stfd2;
AV3(1,11)=av3;ST3(1,11)=st3;FD3(1,11)=avfd3;STFD3(1,11)=stfd3;
AV4(1,11)=av4;ST4(1,11)=st4;FD4(1,11)=avfd4;STFD4(1,11)=stfd4;

%subplot(4,2,1);
%figure('Units','inches','Position',[0 0 3.5 2.8]);




colors=[0.9 0 0;0.5 0.5 0.5;0.8 0 0.8;0 0.45 0.74;];%0.2 0.75 0.3;%0.1 0.4 0.9;%204/255 102/255 0%0.1 0.4 0.9;
%238/255 190/255 4/255
%104/255 138/255 76/255;
%183/255 131/255 175/255;
x21=[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1];
%errorbar(x21,AV1,ST1,'.','MarkerSize',15,'Color',colors(2,:));
%hold on;
%errorbar(x21,AV2,ST2,'.','MarkerSize',15,'Color',colors(1,:));
%hold on;
%errorbar(x21,AV3,ST3,'.','MarkerSize',15,'Color',colors(3,:));
%hold on;
subplot(5,4,1);
plot(x21,AV4,'.','MarkerSize',15,'Color',colors(4,:));
hold on;
plot(x21,AV3,'.','MarkerSize',15,'Color',colors(3,:));
hold on;
plot(x21,AV2,'.','MarkerSize',15,'Color',colors(2,:));
hold on;
plot(x21,AV1,'.','MarkerSize',15,'Color',colors(1,:));
hold on;


x_fine=linspace(min(x21),max(x21),1000);
%po1=polyfit(x21,AV3,10);
%y1_fit=polyval(po1,x_fine);
%fit_line1=plot(x_fine,y1_fit,':','LineWidth',2,'Color',colors(3,:));
%hold on;
po2=polyfit(x21,AV2,10);
y1_fit=polyval(po2,x_fine);
fit_line2=plot(x_fine,y1_fit,'-','LineWidth',2,'Color',colors(2,:));
hold on;

Rsigma1=load('viotf1tf1.mat');
Rsigma2=Rsigma1.VIO;
Rsigma=Rsigma2(201,:);
I1=load('I.mat');
I2=I1.I;
I=I2(201,:);

HEPWCCH1=load('HEPWCCH.mat');
HEPWCCH2=HEPWCCH1.HEPWCCH;
HEP=HEPWCCH2(1,:);
x22=zeros(1,1001);
for i=1:1:1001
    x22(1,i)=(i-1)/1000;
end
plot(x22,Rsigma,':','LineWidth',2,'Color',colors(1,:));
hold on;
plot(x22,I,':','LineWidth',2,'Color',colors(4,:));
hold on;
plot(x22,-HEP+I,':','LineWidth',2,'Color',colors(3,:));
hold on;
%legend('-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\sigma_I^{ex}\rangle-\langle\Delta I\rangle','-\langle\sigma\rangle');




text( 'string','(a) ', 'Units','normalized','position',[0.55,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
hold on;
text( 'string','d=0.2 ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
xlabel('\epsilon');
set(gcf,'Color','white');

hold on;





%calculate wc fixed d change,average FD
AV1=zeros(1,11);ST1=zeros(1,11);FD1=zeros(1,11);STFD1=zeros(1,11);
AV2=zeros(1,11);ST2=zeros(1,11);FD2=zeros(1,11);STFD2=zeros(1,11);
AV3=zeros(1,11);ST3=zeros(1,11);FD3=zeros(1,11);STFD3=zeros(1,11);
AV4=zeros(1,11);ST4=zeros(1,11);FD4=zeros(1,11);STFD4=zeros(1,11);

datastr=load('wcbian\d02wc0\ATEd02wc0.mat');
data=datastr.ATEd02wc0;
datastr1=load('wcbian\d02wc0\FDd02wc0.mat');
data1=datastr1.FDd02wc0;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,1)=av1;ST1(1,1)=st1;FD1(1,1)=avfd1;STFD1(1,1)=stfd1;
AV2(1,1)=av2;ST2(1,1)=st2;FD2(1,1)=avfd2;STFD2(1,1)=stfd2;
AV3(1,1)=av3;ST3(1,1)=st3;FD3(1,1)=avfd3;STFD3(1,1)=stfd3;
AV4(1,1)=av4;ST4(1,1)=st4;FD4(1,1)=avfd4;STFD4(1,1)=stfd4;

datastr=load('wcbian\d02wc01\ATEd02wc01.mat');
data=datastr.ATEd02wc01;
datastr1=load('wcbian\d02wc01\FDd02wc01.mat');
data1=datastr1.FDd02wc01;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,2)=av1;ST1(1,2)=st1;FD1(1,2)=avfd1;STFD1(1,2)=stfd1;
AV2(1,2)=av2;ST2(1,2)=st2;FD2(1,2)=avfd2;STFD2(1,2)=stfd2;
AV3(1,2)=av3;ST3(1,2)=st3;FD3(1,2)=avfd3;STFD3(1,2)=stfd3;
AV4(1,2)=av4;ST4(1,2)=st4;FD4(1,2)=avfd4;STFD4(1,2)=stfd4;

datastr=load('wcbian\d02wc02\ATEd02wc02.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc02\FDd02wc02.mat');
data1=datastr1.FD;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,3)=av1;ST1(1,3)=st1;FD1(1,3)=avfd1;STFD1(1,3)=stfd1;
AV2(1,3)=av2;ST2(1,3)=st2;FD2(1,3)=avfd2;STFD2(1,3)=stfd2;
AV3(1,3)=av3;ST3(1,3)=st3;FD3(1,3)=avfd3;STFD3(1,3)=stfd3;
AV4(1,3)=av4;ST4(1,3)=st4;FD4(1,3)=avfd4;STFD4(1,3)=stfd4;

datastr=load('wcbian\d02wc03\ATEd02wc03.mat');
data=datastr.ATEd02wc03;
datastr1=load('wcbian\d02wc03\FDd02wc03.mat');
data1=datastr1.FDd02wc03;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,4)=av1;ST1(1,4)=st1;FD1(1,4)=avfd1;STFD1(1,4)=stfd1;
AV2(1,4)=av2;ST2(1,4)=st2;FD2(1,4)=avfd2;STFD2(1,4)=stfd2;
AV3(1,4)=av3;ST3(1,4)=st3;FD3(1,4)=avfd3;STFD3(1,4)=stfd3;
AV4(1,4)=av4;ST4(1,4)=st4;FD4(1,4)=avfd4;STFD4(1,4)=stfd4;

datastr=load('wcbian\d02wc04\ATEd02wc04.mat');
data=datastr.ATEd02wc04;
datastr1=load('wcbian\d02wc04\FDd02wc04.mat');
data1=datastr1.FDd02wc04;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,5)=av1;ST1(1,5)=st1;FD1(1,5)=avfd1;STFD1(1,5)=stfd1;
AV2(1,5)=av2;ST2(1,5)=st2;FD2(1,5)=avfd2;STFD2(1,5)=stfd2;
AV3(1,5)=av3;ST3(1,5)=st3;FD3(1,5)=avfd3;STFD3(1,5)=stfd3;
AV4(1,5)=av4;ST4(1,5)=st4;FD4(1,5)=avfd4;STFD4(1,5)=stfd4;

datastr=load('wcbian\d02wc05\ATEd02wc05.mat');
data=datastr.ATEd02wc05;
datastr1=load('wcbian\d02wc05\FDd02wc05.mat');
data1=datastr1.FDd02wc05;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,6)=av1;ST1(1,6)=st1;FD1(1,6)=avfd1;STFD1(1,6)=stfd1;
AV2(1,6)=av2;ST2(1,6)=st2;FD2(1,6)=avfd2;STFD2(1,6)=stfd2;
AV3(1,6)=av3;ST3(1,6)=st3;FD3(1,6)=avfd3;STFD3(1,6)=stfd3;
AV4(1,6)=av4;ST4(1,6)=st4;FD4(1,6)=avfd4;STFD4(1,6)=stfd4;

datastr=load('wcbian\d02wc06\ATEd02wc06.mat');
data=datastr.ATEd02wc06;
datastr1=load('wcbian\d02wc06\FDd02wc06.mat');
data1=datastr1.FDd02wc06;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,7)=av1;ST1(1,7)=st1;FD1(1,7)=avfd1;STFD1(1,7)=stfd1;
AV2(1,7)=av2;ST2(1,7)=st2;FD2(1,7)=avfd2;STFD2(1,7)=stfd2;
AV3(1,7)=av3;ST3(1,7)=st3;FD3(1,7)=avfd3;STFD3(1,7)=stfd3;
AV4(1,7)=av4;ST4(1,7)=st4;FD4(1,7)=avfd4;STFD4(1,7)=stfd4;

datastr=load('wcbian\d02wc07\ATEd02wc07.mat');
data=datastr.ATEd02wc07;
datastr1=load('wcbian\d02wc07\FDd02wc07.mat');
data1=datastr1.FDd02wc07;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,8)=av1;ST1(1,8)=st1;FD1(1,8)=avfd1;STFD1(1,8)=stfd1;
AV2(1,8)=av2;ST2(1,8)=st2;FD2(1,8)=avfd2;STFD2(1,8)=stfd2;
AV3(1,8)=av3;ST3(1,8)=st3;FD3(1,8)=avfd3;STFD3(1,8)=stfd3;
AV4(1,8)=av4;ST4(1,8)=st4;FD4(1,8)=avfd4;STFD4(1,8)=stfd4;

datastr=load('wcbian\d02wc08\ATEd02wc08.mat');
data=datastr.ATEd02wc08;
datastr1=load('wcbian\d02wc08\FDd02wc08.mat');
data1=datastr1.FDd02wc08;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,9)=av1;ST1(1,9)=st1;FD1(1,9)=avfd1;STFD1(1,9)=stfd1;
AV2(1,9)=av2;ST2(1,9)=st2;FD2(1,9)=avfd2;STFD2(1,9)=stfd2;
AV3(1,9)=av3;ST3(1,9)=st3;FD3(1,9)=avfd3;STFD3(1,9)=stfd3;
AV4(1,9)=av4;ST4(1,9)=st4;FD4(1,9)=avfd4;STFD4(1,9)=stfd4;

datastr=load('wcbian\d02wc09\ATEd02wc09.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc09\FDd02wc09.mat');
data1=datastr1.FD;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,10)=av1;ST1(1,10)=st1;FD1(1,10)=avfd1;STFD1(1,10)=stfd1;
AV2(1,10)=av2;ST2(1,10)=st2;FD2(1,10)=avfd2;STFD2(1,10)=stfd2;
AV3(1,10)=av3;ST3(1,10)=st3;FD3(1,10)=avfd3;STFD3(1,10)=stfd3;
AV4(1,10)=av4;ST4(1,10)=st4;FD4(1,10)=avfd4;STFD4(1,10)=stfd4;

datastr=load('wcbian\d02wc10\ATEd02wc10.mat');
data=datastr.ATEd02wc10;
datastr1=load('wcbian\d02wc10\FDd02wc10.mat');
data1=datastr1.FDd02wc10;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);

AV1(1,11)=av1;ST1(1,11)=st1;FD1(1,11)=avfd1;STFD1(1,11)=stfd1;
AV2(1,11)=av2;ST2(1,11)=st2;FD2(1,11)=avfd2;STFD2(1,11)=stfd2;
AV3(1,11)=av3;ST3(1,11)=st3;FD3(1,11)=avfd3;STFD3(1,11)=stfd3;
AV4(1,11)=av4;ST4(1,11)=st4;FD4(1,11)=avfd4;STFD4(1,11)=stfd4;

%subplot(4,2,1);
%figure('Units','inches','Position',[0 0 3.5 2.8]);
hold on;

colors=[0.9 0 0;0.8 0.4 0;0.35 0 0.85;0 0.6 0.5];
%colors=[0.9 0 0;0 0.2 0.5;0 0.5 0.4;0.5 0.25 0.1];
colors1=[0.9 0 0;0.5 0.5 0.5;0 0.45 0.74;0.8 0 0.8];
%0.2 0.75 0.3;%0.1 0.4 0.9;%204/255 102/255 0%0.1 0.4 0.9;
%238/255 190/255 4/255
%104/255 138/255 76/255;
%183/255 131/255 175/255;
x21=[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1];


subplot(5,4,2);
errorbar(x21,FD1,STFD1,'o','Color',colors(2,:));
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;
text( 'string','(b) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   

subplot(5,4,3);
errorbar(x21,FD2,STFD2,'*','Color',colors(3,:));
ylim([0.995 1.005]);
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;
text( 'string','(c) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   





subplot(5,4,4);

y_interval=0.01;
y_max=1.01;
y_break_start=0.82;
y_break_end=0.99;
adjust_value=0.4*y_interval; 
uptate_num=y_break_end-y_break_start-y_interval; 
for i=1:10
    if FD3(1, i)>y_break_end
        FD3(1, i)=FD3(1, i)-uptate_num;
    end
end

errorbar(x21,FD3,STFD3,'r.','MarkerSize',8);
xlim([0 1]);
hold on;
plot([0 1],[1-uptate_num 1-uptate_num],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;



ylimit=get(gca,'ylim');
location_Y=(y_break_start+adjust_value-ylimit(1))/diff(ylimit);
t1=text(0, location_Y,'//','sc','BackgroundColor','w','margin',eps, 'fontsize',13);
set(t1,'rotation',90);
t2=text(1, location_Y,'//','sc','BackgroundColor','w','margin',eps, 'fontsize',13);
set(t2,'rotation',90);
 

ytick=0.77:y_interval:y_max;
set(gca,'ytick',ytick);
ytick(ytick>y_break_start+eps)=ytick(ytick>y_break_start+eps)+uptate_num;
for i=1:length(ytick)
   yticklabel{i}=sprintf('%d',ytick(i));
end
set(gca,'yTickLabel', yticklabel, 'FontSize', 12, 'FontName', 'Times New Roman'); 
text( 'string','(d) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
set(gca,'Layer','top','FontSize',12,'Fontname', 'Times New Roman');




subplot(5,4,5);
errorbar(x21,FD4,STFD4,'v','Color',colors(4,:));
ylim([0.999 1.001]);
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
text( 'string','(e) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
hold on;
xlabel('\epsilon');


hold on;

%plot(x21,AV4,'.','MarkerSize',15,'Color',colors(4,:));
%hold on;
%plot(x21,AV3,'.','MarkerSize',15,'Color',colors(3,:));
%hold on;
%plot(x21,AV2,'.','MarkerSize',15,'Color',colors(1,:));
%hold on;
%plot(x21,AV1,'.','MarkerSize',15,'Color',colors(2,:));
%hold on;


%x_fine=linspace(min(x21),max(x21),1000);
%po1=polyfit(x21,AV3,10);
%y1_fit=polyval(po1,x_fine);
%fit_line1=plot(x_fine,y1_fit,'--','LineWidth',2,'Color',colors(3,:));
%hold on;
%po2=polyfit(x21,AV2,10);
%y1_fit=polyval(po2,x_fine);
%fit_line2=plot(x_fine,y1_fit,':','LineWidth',2,'Color',colors(1,:));
%hold on;

%Rsigma1=load('viotf1tf1.mat');
%Rsigma2=Rsigma1.VIO;
%Rsigma=Rsigma2(201,:);
%I1=load('I.mat');
%I2=I1.I;
%I=I2(201,:);
%x22=zeros(1,1001);
%for i=1:1:1001
%    x22(1,i)=(i-1)/1000;
%end
%plot(x22,Rsigma,'LineWidth',2,'Color',colors(2,:));
%hold on;
%plot(x22,I,':','LineWidth',2,'Color',colors(4,:));
%hold on;
%legend('-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\sigma_I^{ex}\rangle-\langle\Delta I\rangle','-\langle\sigma\rangle');

%title('(a) d=0.2');


AV1=zeros(1,11);ST1=zeros(1,11);FD1=zeros(1,11);STFD1=zeros(1,11);
AV2=zeros(1,11);ST2=zeros(1,11);FD2=zeros(1,11);STFD2=zeros(1,11);
AV3=zeros(1,11);ST3=zeros(1,11);FD3=zeros(1,11);STFD3=zeros(1,11);
AV4=zeros(1,11);ST4=zeros(1,11);FD4=zeros(1,11);STFD4=zeros(1,11);

datastr=load('dchange\wc02d0\ATEwc02d0.mat');
data=datastr.ATEwc02d0;
datastr1=load('dchange\wc02d0\FDwc02d0.mat');
data1=datastr1.FDwc02d0;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,1)=av1;ST1(1,1)=st1;FD1(1,1)=avfd1;STFD1(1,1)=stfd1;
AV2(1,1)=av2;ST2(1,1)=st2;FD2(1,1)=avfd2;STFD2(1,1)=stfd2;
AV3(1,1)=av3;ST3(1,1)=st3;FD3(1,1)=avfd3;STFD3(1,1)=stfd3;
AV4(1,1)=av4;ST4(1,1)=st4;FD4(1,1)=avfd4;STFD4(1,1)=stfd4;

datastr=load('dchange\wc02d01\ATEwc02d01.mat');
data=datastr.ATEwc02d01;
datastr1=load('dchange\wc02d01\FDwc02d01.mat');
data1=datastr1.FDwc02d01;

fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,2)=av1;ST1(1,2)=st1;FD1(1,2)=avfd1;STFD1(1,2)=stfd1;
AV2(1,2)=av2;ST2(1,2)=st2;FD2(1,2)=avfd2;STFD2(1,2)=stfd2;
AV3(1,2)=av3;ST3(1,2)=st3;FD3(1,2)=avfd3;STFD3(1,2)=stfd3;
AV4(1,2)=av4;ST4(1,2)=st4;FD4(1,2)=avfd4;STFD4(1,2)=stfd4;

datastr=load('wcbian\d02wc02\ATEd02wc02.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc02\FDd02wc02.mat');
data1=datastr1.FD;

fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,3)=av1;ST1(1,3)=st1;FD1(1,3)=avfd1;STFD1(1,3)=stfd1;
AV2(1,3)=av2;ST2(1,3)=st2;FD2(1,3)=avfd2;STFD2(1,3)=stfd2;
AV3(1,3)=av3;ST3(1,3)=st3;FD3(1,3)=avfd3;STFD3(1,3)=stfd3;
AV4(1,3)=av4;ST4(1,3)=st4;FD4(1,3)=avfd4;STFD4(1,3)=stfd4;

datastr=load('dchange\wc02d03\ATEwc02d03.mat');
data=datastr.ATEwc02d03;
datastr1=load('dchange\wc02d03\FDwc02d03.mat');
data1=datastr1.FDwc02d03;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,4)=av1;ST1(1,4)=st1;FD1(1,4)=avfd1;STFD1(1,4)=stfd1;
AV2(1,4)=av2;ST2(1,4)=st2;FD2(1,4)=avfd2;STFD2(1,4)=stfd2;
AV3(1,4)=av3;ST3(1,4)=st3;FD3(1,4)=avfd3;STFD3(1,4)=stfd3;
AV4(1,4)=av4;ST4(1,4)=st4;FD4(1,4)=avfd4;STFD4(1,4)=stfd4;

datastr=load('dchange\wc02d04\ATEwc02d04.mat');
data=datastr.ATEwc02d04;
datastr1=load('dchange\wc02d04\FDwc02d04.mat');
data1=datastr1.FDwc02d04;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,5)=av1;ST1(1,5)=st1;FD1(1,5)=avfd1;STFD1(1,5)=stfd1;
AV2(1,5)=av2;ST2(1,5)=st2;FD2(1,5)=avfd2;STFD2(1,5)=stfd2;
AV3(1,5)=av3;ST3(1,5)=st3;FD3(1,5)=avfd3;STFD3(1,5)=stfd3;
AV4(1,5)=av4;ST4(1,5)=st4;FD4(1,5)=avfd4;STFD4(1,5)=stfd4;

datastr=load('dchange\wc02d05\ATEwc02d05.mat');
data=datastr.ATEwc02d05;
datastr1=load('dchange\wc02d05\FDwc02d05.mat');
data1=datastr1.FDwc02d05;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,6)=av1;ST1(1,6)=st1;FD1(1,6)=avfd1;STFD1(1,6)=stfd1;
AV2(1,6)=av2;ST2(1,6)=st2;FD2(1,6)=avfd2;STFD2(1,6)=stfd2;
AV3(1,6)=av3;ST3(1,6)=st3;FD3(1,6)=avfd3;STFD3(1,6)=stfd3;
AV4(1,6)=av4;ST4(1,6)=st4;FD4(1,6)=avfd4;STFD4(1,6)=stfd4;

datastr=load('dchange\wc02d06\ATEwc02d06.mat');
data=datastr.ATEwc02d06;
datastr1=load('dchange\wc02d06\FDwc02d06.mat');
data1=datastr1.FDwc02d06;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,7)=av1;ST1(1,7)=st1;FD1(1,7)=avfd1;STFD1(1,7)=stfd1;
AV2(1,7)=av2;ST2(1,7)=st2;FD2(1,7)=avfd2;STFD2(1,7)=stfd2;
AV3(1,7)=av3;ST3(1,7)=st3;FD3(1,7)=avfd3;STFD3(1,7)=stfd3;
AV4(1,7)=av4;ST4(1,7)=st4;FD4(1,7)=avfd4;STFD4(1,7)=stfd4;

datastr=load('dchange\wc02d07\ATEwc02d07.mat');
data=datastr.ATEwc02d07;
datastr1=load('dchange\wc02d07\FDwc02d07.mat');
data1=datastr1.FDwc02d07;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,8)=av1;ST1(1,8)=st1;FD1(1,8)=avfd1;STFD1(1,8)=stfd1;
AV2(1,8)=av2;ST2(1,8)=st2;FD2(1,8)=avfd2;STFD2(1,8)=stfd2;
AV3(1,8)=av3;ST3(1,8)=st3;FD3(1,8)=avfd3;STFD3(1,8)=stfd3;
AV4(1,8)=av4;ST4(1,8)=st4;FD4(1,8)=avfd4;STFD4(1,8)=stfd4;

datastr=load('dchange\wc02d08\ATEwc02d08.mat');
data=datastr.ATEwc02d08;
datastr1=load('dchange\wc02d08\FDwc02d08.mat');
data1=datastr1.FDwc02d08;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,9)=av1;ST1(1,9)=st1;FD1(1,9)=avfd1;STFD1(1,9)=stfd1;
AV2(1,9)=av2;ST2(1,9)=st2;FD2(1,9)=avfd2;STFD2(1,9)=stfd2;
AV3(1,9)=av3;ST3(1,9)=st3;FD3(1,9)=avfd3;STFD3(1,9)=stfd3;
AV4(1,9)=av4;ST4(1,9)=st4;FD4(1,9)=avfd4;STFD4(1,9)=stfd4;

datastr=load('dchange\wc02d09\ATEwc02d09.mat');
data=datastr.ATEwc02d09;
datastr1=load('dchange\wc02d09\FDwc02d09.mat');
data1=datastr1.FDwc02d09;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,10)=av1;ST1(1,10)=st1;FD1(1,10)=avfd1;STFD1(1,10)=stfd1;
AV2(1,10)=av2;ST2(1,10)=st2;FD2(1,10)=avfd2;STFD2(1,10)=stfd2;
AV3(1,10)=av3;ST3(1,10)=st3;FD3(1,10)=avfd3;STFD3(1,10)=stfd3;
AV4(1,10)=av4;ST4(1,10)=st4;FD4(1,10)=avfd4;STFD4(1,10)=stfd4;

datastr=load('dchange\wc02d10\ATEwc02d10.mat');
data=datastr.ATEwc02d10;
datastr1=load('dchange\wc02d10\FDwc02d10.mat');
data1=datastr1.FDwc02d10;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,11)=av1;ST1(1,11)=st1;FD1(1,11)=avfd1;STFD1(1,11)=stfd1;
AV2(1,11)=av2;ST2(1,11)=st2;FD2(1,11)=avfd2;STFD2(1,11)=stfd2;
AV3(1,11)=av3;ST3(1,11)=st3;FD3(1,11)=avfd3;STFD3(1,11)=stfd3;
AV4(1,11)=av4;ST4(1,11)=st4;FD4(1,11)=avfd4;STFD4(1,11)=stfd4;

%subplot(4,2,1);
%figure('Units','inches','Position',[0 0 3.5 2.8]);
hold on; box on; grid on;



colors=[0.9 0 0;0.5 0.5 0.5;0.8 0 0.8;0 0.45 0.74;];
%104/255 138/255 76/255;
%183/255 131/255 175/255;
x21=[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1];

%errorbar(x21,AV4,ST4,'.','MarkerSize',15,'Color',colors(4,:));
%hold on;
%errorbar(x21,AV1,ST1,'.','MarkerSize',15,'Color',colors(1,:));
%hold on;
%errorbar(x21,AV2,ST2,'.','MarkerSize',15,'Color',colors(2,:));
%hold on;
%errorbar(x21,AV3,ST3,'.','MarkerSize',15,'Color',colors(3,:));
%hold on;
subplot(5,4,6);
plot(x21,AV4,'.','MarkerSize',15,'Color',colors(4,:));
hold on;
plot(x21,AV1,'.','MarkerSize',15,'Color',colors(1,:));
hold on;
plot(x21,AV2,'.','MarkerSize',15,'Color',colors(2,:));
hold on;
plot(x21,AV3,'.','MarkerSize',15,'Color',colors(3,:));
hold on;


x_fine=linspace(min(x21),max(x21),1000);
%po1=polyfit(x21,AV3,6);
%y1_fit=polyval(po1,x_fine);
%fit_line1=plot(x_fine,y1_fit,':','LineWidth',2,'Color',colors(3,:));
%hold on;
po2=polyfit(x21,AV2,6);
y1_fit=polyval(po2,x_fine);
fit_line2=plot(x_fine,y1_fit,'-','LineWidth',2,'Color',colors(2,:));
hold on;

Rsigma1=load('viotf1tf1.mat');
Rsigma2=Rsigma1.VIO;
Rsigma3=Rsigma2(:,201);
Rsigma=Rsigma3';
I1=load('Ig.mat');
I2=I1.Ig;
I3=I2(:,201);
I=I3';
HEPdchange1=load('HEPdchange.mat');
HEPdchange2=HEPdchange1.HEPdchange;
HEPd=HEPdchange2(1,:);
x22=zeros(1,1001);
for i=1:1:1001
    x22(1,i)=(i-1)/1000;
end
plot(x22,Rsigma,':','LineWidth',2,'Color',colors(1,:));
hold on;
plot(x22,I,':','LineWidth',2,'Color',colors(4,:));
hold on;
plot(x22,I-HEPd,':','LineWidth',2,'Color',colors(3,:));
hold on;
%legend('-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\sigma_I^{ex}\rangle-\langle\Delta I\rangle','-\langle\sigma\rangle');


text( 'string','(f) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
text( 'string','\epsilon=0.2', 'Units','normalized','position',[0.55,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
xlabel('d');
xlim([0 1]);
set(gcf,'Color','white');

hold on;

AV1=zeros(1,11);ST1=zeros(1,11);FD1=zeros(1,11);STFD1=zeros(1,11);
AV2=zeros(1,11);ST2=zeros(1,11);FD2=zeros(1,11);STFD2=zeros(1,11);
AV3=zeros(1,11);ST3=zeros(1,11);FD3=zeros(1,11);STFD3=zeros(1,11);
AV4=zeros(1,11);ST4=zeros(1,11);FD4=zeros(1,11);STFD4=zeros(1,11);

datastr=load('dchange\wc02d0\ATEwc02d0.mat');
data=datastr.ATEwc02d0;
datastr1=load('dchange\wc02d0\FDwc02d0.mat');
data1=datastr1.FDwc02d0;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,1)=av1;ST1(1,1)=st1;FD1(1,1)=avfd1;STFD1(1,1)=stfd1;
AV2(1,1)=av2;ST2(1,1)=st2;FD2(1,1)=avfd2;STFD2(1,1)=stfd2;
AV3(1,1)=av3;ST3(1,1)=st3;FD3(1,1)=avfd3;STFD3(1,1)=stfd3;
AV4(1,1)=av4;ST4(1,1)=st4;FD4(1,1)=avfd4;STFD4(1,1)=stfd4;

datastr=load('dchange\wc02d01\ATEwc02d01.mat');
data=datastr.ATEwc02d01;
datastr1=load('dchange\wc02d01\FDwc02d01.mat');
data1=datastr1.FDwc02d01;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,2)=av1;ST1(1,2)=st1;FD1(1,2)=avfd1;STFD1(1,2)=stfd1;
AV2(1,2)=av2;ST2(1,2)=st2;FD2(1,2)=avfd2;STFD2(1,2)=stfd2;
AV3(1,2)=av3;ST3(1,2)=st3;FD3(1,2)=avfd3;STFD3(1,2)=stfd3;
AV4(1,2)=av4;ST4(1,2)=st4;FD4(1,2)=avfd4;STFD4(1,2)=stfd4;

datastr=load('wcbian\d02wc02\ATEd02wc02.mat');
data=datastr.ATE;
datastr1=load('wcbian\d02wc02\FDd02wc02.mat');
data1=datastr1.FD;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,3)=av1;ST1(1,3)=st1;FD1(1,3)=avfd1;STFD1(1,3)=stfd1;
AV2(1,3)=av2;ST2(1,3)=st2;FD2(1,3)=avfd2;STFD2(1,3)=stfd2;
AV3(1,3)=av3;ST3(1,3)=st3;FD3(1,3)=avfd3;STFD3(1,3)=stfd3;
AV4(1,3)=av4;ST4(1,3)=st4;FD4(1,3)=avfd4;STFD4(1,3)=stfd4;

datastr=load('dchange\wc02d03\ATEwc02d03.mat');
data=datastr.ATEwc02d03;
datastr1=load('dchange\wc02d03\FDwc02d03.mat');
data1=datastr1.FDwc02d03;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,4)=av1;ST1(1,4)=st1;FD1(1,4)=avfd1;STFD1(1,4)=stfd1;
AV2(1,4)=av2;ST2(1,4)=st2;FD2(1,4)=avfd2;STFD2(1,4)=stfd2;
AV3(1,4)=av3;ST3(1,4)=st3;FD3(1,4)=avfd3;STFD3(1,4)=stfd3;
AV4(1,4)=av4;ST4(1,4)=st4;FD4(1,4)=avfd4;STFD4(1,4)=stfd4;

datastr=load('dchange\wc02d04\ATEwc02d04.mat');
data=datastr.ATEwc02d04;
datastr1=load('dchange\wc02d04\FDwc02d04.mat');
data1=datastr1.FDwc02d04;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,5)=av1;ST1(1,5)=st1;FD1(1,5)=avfd1;STFD1(1,5)=stfd1;
AV2(1,5)=av2;ST2(1,5)=st2;FD2(1,5)=avfd2;STFD2(1,5)=stfd2;
AV3(1,5)=av3;ST3(1,5)=st3;FD3(1,5)=avfd3;STFD3(1,5)=stfd3;
AV4(1,5)=av4;ST4(1,5)=st4;FD4(1,5)=avfd4;STFD4(1,5)=stfd4;

datastr=load('dchange\wc02d05\ATEwc02d05.mat');
data=datastr.ATEwc02d05;
datastr1=load('dchange\wc02d05\FDwc02d05.mat');
data1=datastr1.FDwc02d05;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,6)=av1;ST1(1,6)=st1;FD1(1,6)=avfd1;STFD1(1,6)=stfd1;
AV2(1,6)=av2;ST2(1,6)=st2;FD2(1,6)=avfd2;STFD2(1,6)=stfd2;
AV3(1,6)=av3;ST3(1,6)=st3;FD3(1,6)=avfd3;STFD3(1,6)=stfd3;
AV4(1,6)=av4;ST4(1,6)=st4;FD4(1,6)=avfd4;STFD4(1,6)=stfd4;

datastr=load('dchange\wc02d06\ATEwc02d06.mat');
data=datastr.ATEwc02d06;
datastr1=load('dchange\wc02d06\FDwc02d06.mat');
data1=datastr1.FDwc02d06;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,7)=av1;ST1(1,7)=st1;FD1(1,7)=avfd1;STFD1(1,7)=stfd1;
AV2(1,7)=av2;ST2(1,7)=st2;FD2(1,7)=avfd2;STFD2(1,7)=stfd2;
AV3(1,7)=av3;ST3(1,7)=st3;FD3(1,7)=avfd3;STFD3(1,7)=stfd3;
AV4(1,7)=av4;ST4(1,7)=st4;FD4(1,7)=avfd4;STFD4(1,7)=stfd4;

datastr=load('dchange\wc02d07\ATEwc02d07.mat');
data=datastr.ATEwc02d07;
datastr1=load('dchange\wc02d07\FDwc02d07.mat');
data1=datastr1.FDwc02d07;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,8)=av1;ST1(1,8)=st1;FD1(1,8)=avfd1;STFD1(1,8)=stfd1;
AV2(1,8)=av2;ST2(1,8)=st2;FD2(1,8)=avfd2;STFD2(1,8)=stfd2;
AV3(1,8)=av3;ST3(1,8)=st3;FD3(1,8)=avfd3;STFD3(1,8)=stfd3;
AV4(1,8)=av4;ST4(1,8)=st4;FD4(1,8)=avfd4;STFD4(1,8)=stfd4;

datastr=load('dchange\wc02d08\ATEwc02d08.mat');
data=datastr.ATEwc02d08;
datastr1=load('dchange\wc02d08\FDwc02d08.mat');
data1=datastr1.FDwc02d08;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,9)=av1;ST1(1,9)=st1;FD1(1,9)=avfd1;STFD1(1,9)=stfd1;
AV2(1,9)=av2;ST2(1,9)=st2;FD2(1,9)=avfd2;STFD2(1,9)=stfd2;
AV3(1,9)=av3;ST3(1,9)=st3;FD3(1,9)=avfd3;STFD3(1,9)=stfd3;
AV4(1,9)=av4;ST4(1,9)=st4;FD4(1,9)=avfd4;STFD4(1,9)=stfd4;

datastr=load('dchange\wc02d09\ATEwc02d09.mat');
data=datastr.ATEwc02d09;
datastr1=load('dchange\wc02d09\FDwc02d09.mat');
data1=datastr1.FDwc02d09;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,10)=av1;ST1(1,10)=st1;FD1(1,10)=avfd1;STFD1(1,10)=stfd1;
AV2(1,10)=av2;ST2(1,10)=st2;FD2(1,10)=avfd2;STFD2(1,10)=stfd2;
AV3(1,10)=av3;ST3(1,10)=st3;FD3(1,10)=avfd3;STFD3(1,10)=stfd3;
AV4(1,10)=av4;ST4(1,10)=st4;FD4(1,10)=avfd4;STFD4(1,10)=stfd4;

datastr=load('dchange\wc02d10\ATEwc02d10.mat');
data=datastr.ATEwc02d10;
datastr1=load('dchange\wc02d10\FDwc02d10.mat');
data1=datastr1.FDwc02d10;
fd1=data1(:,4);avfd1=mean(fd1);stfd1=std(fd1);
fd2=data1(:,5);avfd2=mean(fd2);stfd2=std(fd2);
fd3=data1(:,6);avfd3=mean(fd3);stfd3=std(fd3);
fd4=data1(:,7);avfd4=mean(fd4);stfd4=std(fd4);
sigma1=-data(:,8);
av1=mean(sigma1);
st1=std(sigma1);
sigma2=-data(:,3)-data(:,6)+data(:,1)-data(:,8);
av2=mean(sigma2);
st2=std(sigma2);
sigma3=-data(:,3)+data(:,1)-data(:,8);
av3=mean(sigma3);
st3=std(sigma3);
sigma4=data(:,1)-data(:,8);
av4=mean(sigma4);
st4=std(sigma4);
AV1(1,11)=av1;ST1(1,11)=st1;FD1(1,11)=avfd1;STFD1(1,11)=stfd1;
AV2(1,11)=av2;ST2(1,11)=st2;FD2(1,11)=avfd2;STFD2(1,11)=stfd2;
AV3(1,11)=av3;ST3(1,11)=st3;FD3(1,11)=avfd3;STFD3(1,11)=stfd3;
AV4(1,11)=av4;ST4(1,11)=st4;FD4(1,11)=avfd4;STFD4(1,11)=stfd4;

%subplot(4,2,1);
%figure('Units','inches','Position',[0 0 3.5 2.8]);
hold on; 


colors=[0.9 0 0;0.8 0.4 0;0.35 0 0.85;0 0.6 0.5];
%colors=[0.9 0 0;0 0.2 0.5;0 0.5 0.4;0.5 0.25 0.1];
colors1=[0.9 0 0;0.5 0.5 0.5;0 0.45 0.74;0.8 0 0.8];
%104/255 138/255 76/255;
%183/255 131/255 175/255;
x21=[0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1];
subplot(5,4,7);
errorbar(x21,FD1,STFD1,'o','Color',colors(2,:));
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;
text( 'string','(g) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   

subplot(5,4,8);
errorbar(x21,FD2,STFD2,'*','Color',colors(3,:));
ylim([0.995 1.005]);
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;
text( 'string','(h) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   

subplot(5,4,9);
errorbar(x21,FD3,STFD3,'r.','MarkerSize',8);
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
hold on;
text( 'string','(i) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   

subplot(5,4,10);
errorbar(x21,FD4,STFD4,'v','Color',colors(4,:));
ylim([0.999 1.001]);
xlim([0 1]);
hold on;
plot([0 1],[1 1],'--','Color',colors1(2,:),'Linewidth',0.5);
text( 'string','(j) ', 'Units','normalized','position',[0.05,0.95],  'FontSize',14,'FontWeight','Bold','FontName','Times New Roman');   
hold on;

%plot(x21,AV4,'.','MarkerSize',15,'Color',colors(4,:));
%hold on;
%plot(x21,AV3,'.','MarkerSize',15,'Color',colors(3,:));
%hold on;
%plot(x21,AV2,'.','MarkerSize',15,'Color',colors(1,:));
%hold on;
%plot(x21,AV1,'.','MarkerSize',15,'Color',colors(2,:));
%hold on;


%x_fine=linspace(min(x21),max(x21),1000);
%po1=polyfit(x21,AV3,10);
%y1_fit=polyval(po1,x_fine);
%fit_line1=plot(x_fine,y1_fit,'--','LineWidth',2,'Color',colors(3,:));
%hold on;
%po2=polyfit(x21,AV2,10);
%y1_fit=polyval(po2,x_fine);
%fit_line2=plot(x_fine,y1_fit,':','LineWidth',2,'Color',colors(1,:));
%hold on;

%Rsigma1=load('viotf1tf1.mat');
%Rsigma2=Rsigma1.VIO;
%Rsigma=Rsigma2(201,:);
%I1=load('I.mat');
%I2=I1.I;
%I=I2(201,:);
%x22=zeros(1,1001);
%for i=1:1:1001
%    x22(1,i)=(i-1)/1000;
%end
%plot(x22,Rsigma,'LineWidth',2,'Color',colors(2,:));
%hold on;
%plot(x22,I,':','LineWidth',2,'Color',colors(4,:));
%hold on;
%legend('-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\Delta I\rangle','-\langle\sigma_{XY}^{hk}\rangle-\langle\sigma_I^{ex}\rangle-\langle\Delta I\rangle','-\langle\sigma\rangle');

%title('(a) d=0.2');
xlabel('d');


hold on;
